<!DOCTYPE html>
<html>
    <head></head>
    <body>
        <h1>This is a mock of mobile client</h1>
        <p>Here we define the interface. Then implement on backend and in mobile client.</p>
        <h2>Elements to implement</h2>
        <ul>
            <strike><li>Connect field: to connect clients to each other</li>
            <ul>
                <li>sends to the server the id of other</li>
            </ul>
            </strike>
            <li>Player / Host switch</li>
            <li>Common elements</li>
            <ul>
                <li>List of teams</li>
            </ul>
            <li>Player screen</li>
            <ul>
                <li>Team name</li>
                <li>Button</li>
            </ul>
            <li>Host screen</li>
            <ul>
                <li>Timer button</li>
                <li>Reset button</li>
                <li>Settings</li>
            </ul>
        </ul>
        
        <div id='connection'>
            <input id='clientId'></h4>
            <input id='connectInput' placeholder="other's clientId">
            <input type='radio' id='host' name='host' value=true>
            <label>Host</label>
            <input type='radio' id='player' name='host' value=false checked=true>
            <label>Player</label>
        </div>
        <ul id='teams'></ul>
        <div id='controls'></div>

        <script src="/socket.io/socket.io.js"></script>
        <script>
            const clientIdField = document.getElementById('clientId')
            const socket = io("ws://localhost:3000");
            const input = document.getElementById("input");
            const button = document.getElementById("button");
            const messages = document.getElementById("messages")
            const connectInput = document.getElementById('connectInput')
            const teamList = document.getElementById('teams')

            connectInput.addEventListener("change", () => {
                socket.emit("join", connectInput.value)
            })

            socket.on('room update', (msg) => {
                teamList.innerHTML=JSON.parse(msg).map(item => {
                    const status = item.connected ? ' | online' : ' | offline'
                    return '<li id="'+item.clientId+'">'+item.clientId + status + '</li>'
                })
            })

            socket.on("connect", () => {
                if(clientIdField.value) {
                    socket.emit('clientId', clientIdField.value)
                }
            })

            clientIdField.addEventListener("change", () => {
                if(clientIdField.value) {
                    socket.emit('clientId', clientIdField.value)
                }
            })
        </script>
    </body>
</html>